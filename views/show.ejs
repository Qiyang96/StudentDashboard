<%- include('./partials/head') %>
<head>
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<h3><%= student.name %></h3>
<!-- Tabs -->
<ul class="nav nav-tabs" id="myTab" role="tablist">
	<li class="nav-item" role="presentation">
		<button
			class="nav-link active"
			id="home-tab"
			data-bs-toggle="tab"
			data-bs-target="#home"
			type="button"
			role="tab"
			aria-controls="home"
			aria-selected="true"
		>
			Homework
		</button>
	</li>
	<li class="nav-item" role="presentation">
		<button
			class="nav-link"
			id="profile-tab"
			data-bs-toggle="tab"
			data-bs-target="#profile"
			type="button"
			role="tab"
			aria-controls="profile"
			aria-selected="false"
		>
			Past Assessments
		</button>
	</li>
</ul>
<!-- div content -->
<div class="tab-content" id="myTabContent" style="background-color: #f0cc71">
	<div class="hack"></div>
	<div
		class="tab-pane fade show active"
		id="home"
		role="tabpanel"
		aria-labelledby="home-tab"
	>
		<form
			action="/students/<%= student.slug %>/homeworks"
			method="post"
			class="show-form"
		>
			<input
				type="text"
				name="student"
				placeholders="student"
				class="form-control"
				value="<%= student.slug %>"
				style="display: none"
			/>
			<input
				type="date"
				name="date"
				class="form-control"
				placeholder="Date"
				style="margin-bottom: 5px"
			/>
			<input
				type="text"
				name="homework"
				class="form-control"
				placeholder="Homework"
				style="margin-bottom: 5px"
			/>
			<input
				type="text"
				name="comments"
				class="form-control"
				placeholder="Other comments"
				style="margin-bottom: 5px"
			/>
			<input type="submit" value="Create" />
		</form>
		<table class="table show-table">
			<thead class="thead-dark">
				<tr>
					<th scope="col">Date</th>
					<th scope="col">Homework</th>
					<th scope="col">Comments</th>
					<th scope="col">Actions</th>
				</tr>
			</thead>
			<tbody>
				<% if (student.homework.length !== 0) { %> <%
				student.homework.forEach((element, index) => { %> <% let newDate =
				element.date.toDateString(); %>

				<tr
					style="
						margin-left: 50px;
						margin-right: 50px;
						padding: 20px;
						background-color: aliceblue;
					"
				>
					<td><%= newDate %></td>
					<td><%= element.homework %></td>
					<td><%= element.comments %></td>
					<td>
						<a
							href="/students/<%= student.slug %>/homeworks/<%= element._id %>/edit"
						>
							<img
								src="https://image.flaticon.com/icons/png/512/860/860814.png"
								class="icons"
							/>
						</a>

						<form
							method="post"
							action="/students/<%= student.slug %>/homeworks/<%= element._id %>?_method=DELETE"
						>
							<input
								class="icons"
								type="image"
								id="image"
								alt="Login"
								src="https://image.flaticon.com/icons/png/512/709/709518.png"
							/>
						</form>
					</td>
				</tr>
				<% }); %> <% } else { %>
				<p>No log to display</p>
				<% } %>
			</tbody>
		</table>
	</div>
	<div
		class="tab-pane fade"
		id="profile"
		role="tabpanel"
		aria-labelledby="profile-tab"
	>
		<div class="hack"></div>
		<div class="show-table" style="background-color: aliceblue">
			<canvas id="myChart"
				><script>
					var ctx = document.getElementById('myChart');
					ctx.height = 100;
					var myChart = new Chart(ctx, {
						type: 'line',
						data: {
							labels: '<%= paper %>'.split(','),
							datasets: [
								{
									label: 'Maths Scores',
									data: '<%= score %>'.split(','),
									backgroundColor: ['rgba(255, 99, 132, 0.2)'],
									borderColor: ['rgba(255, 99, 132, 1)'],
									borderWidth: 3,
								},
							],
						},
						options: {
							responsive: true,
							plugins: {
								legend: {
									position: 'top',
								},
								title: {
									display: true,
									text: 'Test Scores',
								},
							},
						},
					});
				</script></canvas
			>
		</div>
		<div class="tab-pane">
			<table class="table show-table">
				<thead class="thead-dark">
					<tr>
						<th scope="col">Date</th>
						<th scope="col">Paper</th>
						<th scope="col">Score</th>
						<th scope="col">Actions</th>
					</tr>
				</thead>
				<tbody>
					<% if (student.assessments.length !== 0) { %> <%
					student.assessments.forEach((element, index) => { %>

					<tr
						style="
							margin-left: 50px;
							margin-right: 50px;
							padding: 20px;
							background-color: aliceblue;
						"
					>
						<td><%= element.date %></td>
						<td><%= element.testPaper %></td>
						<td><%= element.score %></td>
						<td>
							<a
								href="/students/<%= student.slug %>/assessments/<%= element._id %>/edit"
							>
								<img
									src="https://image.flaticon.com/icons/png/512/860/860814.png"
									class="icons"
								/>
							</a>

							<form
								method="post"
								action="/students/<%= student.slug %>/assessments/<%= element._id %>?_method=DELETE"
							>
								<input
									class="icons"
									type="image"
									id="image"
									alt="Login"
									src="https://image.flaticon.com/icons/png/512/709/709518.png"
								/>
							</form>
						</td>
					</tr>
					<% }); %> <% } else { %>
					<p>No log to display</p>
					<% } %>
				</tbody>
			</table>

			<form
				action="/students/<%= student.slug %>/assessments"
				method="post"
				class="show-form"
			>
				<input
					type="text"
					name="student"
					placeholder="student"
					value="<%= student.slug %>"
					style="display: none"
				/>
				<input
					type="date"
					name="date"
					placeholder="Date"
					class="form-control"
					style="margin-bottom: 5px"
				/>
				<input
					type="text"
					name="testPaper"
					placeholder="Paper"
					class="form-control"
					style="margin-bottom: 5px"
				/>
				<input
					type="text"
					name="score"
					placeholder="Score"
					class="form-control"
					style="margin-bottom: 5px"
				/>
				<input type="submit" value="Create" />
			</form>
		</div>
	</div>
</div>
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
	crossorigin="anonymous"
></script>
